{% extends "layout.html" %}
{% block content %}

<!--<h2>Human Resources - Employees</h2>-->
<div class="d-flex align-items-center justify-content-between mb-3">
    <h2 class="mb-0">Human Resources - Employees</h2>
    <div class="d-flex gap-2">
        <button id="btn-add-employee" class="btn btn-success">
            Add Employee
        </button>
    </div>
</div>

<div class="row">
    <div class="col-md-8">
        <div style="max-height: 500px; overflow-y: auto; border: 1px solid #ddd; padding: 5px;">
            <table id="employeeTable" class="table table-striped">
                <thead>
                    <tr>
                        <th>Employee No</th>
                        <th>Name</th>
                        <th>Title</th>
                        <th>Department</th>
                        <th>Division</th>
                        <th>Employment Start</th>
                        <th>Employment End</th>
                        <th>Is Active</th>
                    </tr>
                </thead>
                <tbody>
                    {% for emp in employees %}
                    <tr data-employee-no="{{ emp.employee_no }}"
                        data-employee-name="{{ emp.employee_name }}"
                        data-current-salary="{{ emp.salary if emp.salary else '' }}"
                        data-salary-type="{{ emp.salary_type if emp.salary_type else '' }}">
                        <td>{{ emp.employee_no }}</td>
                        <td>{{ emp.employee_name }}</td>
                        <td>{{ emp.title }}</td>
                        <td>{{ emp.department_name }}</td>

                        <td>
                            {% if not emp.department_name and emp.title.startswith('Head of ') %}
                            {{ emp.title[8:] }} {# Extract substring after 'Head of ' #}
                            {% else %}
                            {{ emp.division_name }}
                            {% endif %}
                        </td>
                        <td>{{ emp.employment_start_date.strftime('%Y-%m-%d') if emp.employment_start_date else '' }}</td>
                        <td>{{ emp.employment_end_date.strftime('%Y-%m-%d') if emp.employment_end_date else '' }}</td>
                        <td>{{ 'Yes' if emp.is_active else 'No' }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <div class="col-md-4">
        <h3>Employee Salary Details</h3>
        <table id="salaryDetailsTable" class="table table-bordered">
            <tbody>
                <tr><th>Employee No</th><td id="detail-empno" class="text-end"></td></tr>
                <tr><th>Name</th><td id="detail-name" class="text-end"></td></tr>
                <tr><th>Salary Type</th><td id="detail-salary-type" class="text-end"></td></tr>
                <tr><th>Current Salary</th><td id="detail-current-salary" class="text-end"></td></tr>
                <tr>
                    <th>New Salary</th>
                    <td class="text-end">
                        <input type="number" id="input-new-salary" min="0" step="0.01"
                               placeholder="Enter new salary"
                               style="width: 130px; text-align: right;">
                    </td>
                </tr>
                <tr>
                    <th>Percent Increase (%)</th>
                    <td class="text-end">
                        <input type="number" id="input-percent-increase" min="0" step="0.01"
                               placeholder="Enter percent"
                               style="width: 130px; text-align: right;">
                    </td>
                </tr>
            </tbody>
        </table>

        <div class="d-flex mt-2 gap-2">
            <button id="btn-set-salary" class="btn btn-primary flex-grow-1">Set New Salary</button>
            <button id="btn-view-history" class="btn btn-secondary flex-grow-1">View Salary History</button>
            <button id="btn-set-status" class="btn btn-secondary flex-grow-1">Set Status</button>
        </div>
        <div id="salary-msg" class="mt-2"></div>
    </div>
</div>

{% include "add_employee_modal.html" %}
{% include "Salary_history_modal.html" %}
{% include "status_modal.html" %}

<script src="{{ url_for('static', filename='scripts/human_resources.js') }}"></script>

{% endblock %}
